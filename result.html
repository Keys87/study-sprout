<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="public/logo-trans.png" type="image/x-icon" />
  <link rel="stylesheet" href="out.css" />
  <title>Study Sprout</title>
</head>

<body class="p-0 m-0 flex w-screen h-screen md:flex-row flex-col text-main font-primary-text bg-primary-bg">

  <!-- Sidebar (Your existing Navigation) -->
  <nav
    class="h-fit md:h-screen md:w-56 md:p-2 gap-8 md:gap-2 w-screen flex md:flex-col flex-row items-center bg-primary-bg shadow-xl shadow-shadow z-50">
    <!-- Logo -->
    <div class="mt-8 mb-10 ms-4">
      <a href="index.html">
        <img src="public/logo-trans.png" class="h-12 md:h-16 w-auto" />
      </a>
    </div>

    <!-- Links with icons -->
    <div class="flex md:flex-col flex-row items-center gap-8 text-center">
      <a href="opportunities.html" class="flex flex-col items-center gap-2 text-main hover:font-bold transition group">
        <img src="public/icons/door-open.svg" alt="Opportunities"
          class="h-8 w-8 object-contain group-hover:scale-110 transition" />
        <span class="text-xs md:text-base">Opportunities</span>
      </a>
      <a href="contact.html" class="flex flex-col items-center gap-2 text-main hover:font-bold transition group">
        <img src="public/icons/telephone.svg" alt="Contact Us"
          class="h-8 w-8 object-contain group-hover:scale-110 transition" />
        <span class="text-xs md:text-base">Contact Us</span>
      </a>
    </div>
  </nav>

  <!-- Search result section -->
  <section role="primary-text" class="flex flex-col w-full p-2 px-0 overflow-y-scroll flex-nowrap gap-2 mt-6 md:mt-0"
    id="universe">
    <!-- Injection of resource components here -->
  </section>

  <!-- Script A: Creating the resources page for each subject of each curriculum -->
  <script type="module">
    import { rss } from "./public/rss.js";
    import { desc } from "./public/desc.js";

    // Detecting the URL
    const url = new URLSearchParams(window.location.search)
    const params = {
      "curr": url.get("curr"),
      "subject": url.get("subject")
    }
    console.log(`current curriculum: ${params.curr}\ncurrent subject: ${params.subject}`)

    // Fetching resources specific to that subject to populate the page
    const subjectResources = rss[params.subject]

    // Applicator function to create the HTML
    const resourceApplicator = (name, link, desc) => {
      // Check if viewport matches a media query
      const isMobile = window.matchMedia('(pointer: coarse)').matches;

      if (isMobile) {
        const element = `
        <div class="relative group flex flex-col w-full flex-nowrap p-2 border-b-2 border-primary transition">
          <a class="font-bold text-xl text-main underline" href="${link}">${name}</a>
          <p class="">${desc}</p>
        </div>
        `
        return element

      } else {
        const element = `
        <div class="relative w-full group flex flex-row flex-nowrap rounded-xl rounded-b-none transition border-b-2 border-primary-var1 py-2">
          <div class="flex flex-col w-full p-2 ps-4">
            <p class="font-bold text-xl text-main">${name}</p>  
            <p class="">${desc}</p>
          </div>
          <a href="${link}" class="p-2 w-fit me-2 text-nowrap transition overflow-clip rounded-xl items-center align-baseline hidden group-hover:inline-flex h-full bg-linear-90 from-primary from-10% to-primary-var1 to-95% hover:from-tertiary-var1 hover:to-tertiary-var2">Click Here</a>
        </div>
        `
        return element
      }
    }

    // Populating page
    for (let i = 0; i < subjectResources.length; i++) {
      const universe = document.getElementById("universe")
      const name = subjectResources[i][0]
      const link = subjectResources[i][1]
      const description = desc[name]

      universe.insertAdjacentHTML("beforeend", resourceApplicator(name, link, description))
    }

  </script>

</body>

</html>